// Generated by CoffeeScript 1.9.3
var isURLValid;

$(document).ready(function() {
  $('#type').change(function() {
    if ($(this).val() === 'GET') {
      return $('#typeWrapper').addClass('hide');
    } else if ($(this).val() === 'POST') {
      return $('#typeWrapper').removeClass('hide');
    }
  });
  $('#newURLButton').click(function() {
    var URL, data, jsonError;
    event.preventDefault();
    $('.newURLAlert').addClass('hide');
    URL = $('#url').val();
    if (!isURLValid(URL)) {
      $('#newURLErrorURL').removeClass('hide');
      return;
    }
    data = $('#data').val();
    if (data) {
      try {
        $.parseJSON(data);
      } catch (_error) {
        jsonError = _error;
        $('#newURLErrorData').removeClass('hide');
        return;
      }
    }
    console.log($('#newURLForm').serialize());
    return $.post('/add', $('#newURLForm').serialize()).done(function() {
      var URLCell, averageCell, dataCell, durationsCell, row, type, typeCell;
      $('#newURLSuccess').removeClass('hide');
      URLCell = document.createElement('td');
      $(URLCell).append(URL);
      typeCell = document.createElement('td');
      type = $('#type').val();
      $(typeCell).append(type);
      dataCell = document.createElement('td');
      data = $('#data').val();
      $(dataCell).append(data);
      row = document.createElement('tr');
      durationsCell = document.createElement('td');
      averageCell = document.createElement('td');
      $(row).append(URLCell, typeCell, dataCell, durationsCell, averageCell);
      return $('#URLTable').append(row);
    }).fail(function(requestError) {
      return $("#" + requestError['responseText']).removeClass('hide');
    });
  });
  return $('#runChecksButton').click(function() {
    event.preventDefault();
    return $.get('/run', {}).done(function() {
      return $('#checkRunAlert').removeClass('hide');
    });
  });
});

isURLValid = function(url) {
  return /^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(url);
};
